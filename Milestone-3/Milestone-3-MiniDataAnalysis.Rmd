---
title: "STAT545A Individual Mini Data Analysis-Milestone 3"
author: "Sara Kowalski"
date: "October 19, 2021"
output: github_document
---



## Table of Contents
1. Introduction

2. Load packages
    + 2.1 Load **datateachr** and **tidyverse**
    + 2.2 My research questions
    
3. Task 1: Special data types
    + 3.1 Reordering factors 
    + 3.2 Modifying time 

4. Task 2: Modelling
    + 4.1 Research question and variable of interest
    + 4.2 Hypothesis testing
        + 4.2.1 P-value 

5. Task 3: Reading and writing data
    + 5.1 Write a csv file
    + 5.2 Write a R binary file


## 1  Introduction
Hello! The following document contains the work required to complete Milestone 3 of the Mini Data Analysis Project in STAT545A. Here I will be using R, and more specifically the tidyverse packages within R, to explore special data types, like reordering factors and modifying time data, model data and perform hypothesis testing, and read and write csv and RDS files. I will be using the *vancouver_trees* dataset to complete the tasks outlined in this milestone and more specifically, where appropriate, I will be completing these tasks in relation to the two research questions I chose at the end of milestone 2.    

Much of the inspiration for this script comes from [Heads or Tails](https://www.kaggle.com/headsortails/tidy-titarnic) and from the [instructions](https://stat545.stat.ubc.ca/mini-project/mini-project-3/) provided for the project.

## 2  Load Packages 
### 2.1 Load **datateachr** and **tidyverse**

```{r}
## Load dataset package - datateachr
library(datateachr)

## Load tidyverse - a collection of R packages used for data analysis
library(tidyverse) 
```

### 2.2 My Research Questions

1. Question 1:
What is the distribution for tree species (from a specified genus (e.g. Ulmus)) within Vancouver neighbourhoods? Are certain tree species favored over others in specific neighbourhoods? 

2. Question 2:
Within each genus, what is the distribution of the diameter of the trees for each species? Which species have a wider diameter distribution and which ones have a more narrow distribution?

## 3  Task 1: Special data types
### 3.1 Reordering factors

For this task I have decided to take a plot I produced in milestone 2 (to answer question 1) which involved plotting across the three groups: *neighbourhood_name*, *number of trees*, and *species_name*, and produce a new plot with the neighbourhoods reordered in ascending order (i.e. the neighbourhood with the least amount of trees on the far left with it increasing up to the neighbourhood with the most amount of trees on the far right). I will complete this task using the tools in the **forcats** package which was designed for working with and reordering factors. 

Here is the code and a visual of the original plot I created in Milestone 2 which looked at how many trees in the **STYRAX** genus were planted in each Vancouver neighbourhood. The graph was further subsetted to show how many of the different types of **STYRAX** species were planted in each neighbourhood by colouring the bars based on the *species_name*.  

```{r}
## define a new place to hold the data to be graphed and call the dataset to be used
styraxGenus <- vancouver_trees %>%
## filter that data so it only contains trees with the STYRAX genus
  filter(genus_name == "STYRAX")

## plot the data using ggplot, set x axis to neighbourhood_name
ggplot(styraxGenus, aes(neighbourhood_name, fill = species_name)) +
## set the graph to a bar graph
  geom_bar() +
## define the x and y axis labels 
  xlab("Neighbourhood") +
  ylab("Number of Trees") +
## declutter the bottom axis by switching x and y 
  coord_flip()
```
To more clearly see how the number of trees planted changes by neighbourhood, I am going to reorder the neighbourhoodds so they appear in ascending order from left to right based on the number of **STYRAX** trees planted. I can achieve this by using the **forcats** function *fct_infreq()* which reorders a factor (neighbourhood) by its number of values (trees planted).   

```{r}
## define a new place to hold the data to be graphed and call the dataset to be used
styraxGenus <- vancouver_trees %>%
## filter that data so it only contains trees with the STYRAX genus
  filter(genus_name == "STYRAX") %>%
## use the mutate function to reorder the neighbourhoods from least amount of trees planted to most
  mutate(neighbourhood_name = fct_infreq(neighbourhood_name))


## plot the data using ggplot, set x axis to neighbourhood_name
ggplot(styraxGenus, aes(neighbourhood_name, fill = species_name)) +
## set the graph to a bar graph
  geom_bar() +
## define the x and y axis labels 
  xlab("Neighbourhood") +
  ylab("Number of Trees") +
## declutter the bottom axis by switching x and y 
  coord_flip() 

```
By reordering the neighbourhood_name variable in ascending order based on the number of trees planted, you can more clearly see which neighbourhoods have a high number of **STYRAX** trees planted and which have low numbers. Further, you can actually distinguish and be confident as to which neighbourhood has the most **STYRAX** trees (Kitsilano) and which neighbourdhood has the least (West End); whereas, before reordering, it was very difficult to be certain since Shauhnessy and Kitsilano are very close in number of trees as are West End and Strathcona. Finally, by reordering the data like this, if there is a trend for a certain area or quadrant of the city to have more **STYRAX** trees, then it would become more apparent and could lead to more research questions. 

### 3.2 Modifying time
In the dataset *vancouver_trees* there is a date column which holds the date of when a tree was planted. For this exercise of modifying a time-based column, I am going to use the **format()** function from the **lubridate** package to modify the *date_planted* column by extracting only the year the tree was planted. 

```{r}
## define the new data subset and call the dataset to be modified 
van_trees_year_planted <- vancouver_trees %>%
## use the format function within the mutate function to modify the existing date_planted column 
## and extract only the year
  mutate(date_planted = format(date_planted, format = "%Y"))
## visualize the new dataset
glimpse(van_trees_year_planted)
```
Modifying the time data to only hold the year the tree was planted might allow for interesting research questions such as investigating which year had the most trees planted or looking to see if there are specific years where certain types of trees were preferentially planted over others, etc. Further, it may be interesting to see if there is a relationship between the year the tree was planted and its diameter (i.e do older trees have larger diameters? Is the diameter of a tree influenced by how old it is?)
